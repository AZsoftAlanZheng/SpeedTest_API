'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (basePath, href) {
  var pathObjectParams = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
  var queryParams = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];

  var parameterNames = _lodash2.default.chain(pathObjectParams).concat(queryParams).filter(function (parameter) {
    return parameter.in === 'query';
  }).uniqBy(function (parameter) {
    return parameter.name;
  }).map(function (parameter) {
    var name = escapeUriTemplateVariable(parameter.name);

    if (parameter.collectionFormat === 'multi') {
      return name + '*';
    }

    return name;
  }).value();

  if (parameterNames.length > 0) {
    var queryString = parameterNames.join(',');
    return '' + basePath + href + '{?' + queryString + '}';
  }

  return basePath + href;
};

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function escapeUriTemplateVariable(variable) {
  return encodeURIComponent(variable).replace(/[-.!~*'()]/g, function (c) {
    return '%' + c.charCodeAt(0).toString(16);
  });
}
//# sourceMappingURL=uri-template.map